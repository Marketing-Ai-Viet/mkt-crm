import { MktKpiCode } from 'src/mkt-core/mkt-kpi/constants/mkt-kpi-options';
import { WORKSPACE_MEMBER_DATA_SEED_IDS } from 'src/engine/workspace-manager/dev-seeder/data/constants/workspace-member-data-seeds.constant';

type MktKpiDataSeed = {
  id: string;
  kpiName: string;
  kpiCode: MktKpiCode;
  kpiType: string;
  kpiCategory: string;
  description?: string;
  targetValue: number;
  actualValue: number;
  unitOfMeasure?: string;
  periodType: string;
  periodYear: number;
  periodQuarter?: number;
  periodMonth?: number;
  periodWeek?: number;
  periodStartDate?: string;
  periodEndDate?: string;
  assigneeType: string;
  status: string;
  achievedAt?: string | null;
  isAutoCalculated?: boolean;
  calculationFormula?: string;
  alertThresholds?: object;
  notes?: string;
  priority?: string;
  weight?: number;
  position?: number;
  assignedToId: string | null;
};

export const MKT_KPI_DATA_SEED_COLUMNS: (keyof MktKpiDataSeed)[] = [
  'id',
  'kpiName',
  'kpiCode',
  'kpiType',
  'kpiCategory',
  'description',
  'targetValue',
  'actualValue',
  'unitOfMeasure',
  'periodType',
  'periodYear',
  'periodQuarter',
  'periodMonth',
  'periodWeek',
  'periodStartDate',
  'periodEndDate',
  'assigneeType',
  'status',
  'achievedAt',
  'isAutoCalculated',
  'calculationFormula',
  'alertThresholds',
  'notes',
  'priority',
  'weight',
  'position',
  'assignedToId',
];

export const MKT_KPI_DATA_SEEDS_IDS = {
  MONTHLY_REVENUE: '1a2b3c4d-5e6f-7a8b-9c0d-1e2f3a4b5c6d',
  NEW_CUSTOMERS: '2b3c4d5e-6f7a-8b9c-0d1e-2f3a4b5c6d7e',
  SALES_CONVERSION_RATE: '3c4d5e6f-7a8b-9c0d-1e2f-3a4b5c6d7e8f',
  SUPPORT_RESPONSE_TIME: '4d5e6f7a-8b9c-0d1e-2f3a-4b5c6d7e8f9a',
  CUSTOMER_SATISFACTION: '5e6f7a8b-9c0d-1e2f-3a4b-5c6d7e8f9a0b',
  MONTHLY_CALLS: '6f7a8b9c-0d1e-2f3a-4b5c-6d7e8f9a0b1c',
  DEMOS_COMPLETED: '7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d',
  DEALS_CLOSED: '8b9c0d1e-2f3a-4b5c-6d7e-8f9a0b1c2d3e',
  CUSTOMER_RETENTION: '9c0d1e2f-3a4b-5c6d-7e8f-9a0b1c2d3e4f',
  TECH_PROJECT_COMPLETION: '0d1e2f3a-4b5c-6d7e-8f9a-0b1c2d3e4f5a',
};

export const MKT_KPI_DATA_SEEDS: MktKpiDataSeed[] = [
  // Monthly Revenue KPI
  {
    id: MKT_KPI_DATA_SEEDS_IDS.MONTHLY_REVENUE,
    kpiName: 'Doanh thu tháng',
    kpiCode: MktKpiCode.MONTHLY_REVENUE,
    kpiType: 'REVENUE',
    kpiCategory: 'SALES',
    description: 'Tổng doanh thu đạt được trong tháng',
    targetValue: 1000000000,
    actualValue: 850000000,
    unitOfMeasure: 'VND',
    periodType: 'MONTHLY',
    periodYear: 2024,
    periodQuarter: 4,
    periodMonth: 12,
    periodWeek: 49,
    periodStartDate: '2024-12-01',
    periodEndDate: '2024-12-31',
    assigneeType: 'DEPARTMENT',
    status: 'IN_PROGRESS',
    achievedAt: null,
    isAutoCalculated: true,
    calculationFormula: 'SUM(orders.amount) WHERE status = "COMPLETED"',
    alertThresholds: {
      warning: 800000000,
      critical: 700000000,
    },
    notes: 'KPI quan trọng nhất của phòng kinh doanh',
    priority: 'HIGH',
    weight: 100,
    position: 1,
    assignedToId: WORKSPACE_MEMBER_DATA_SEED_IDS.TIM,
  },

  // New Customers KPI
  {
    id: MKT_KPI_DATA_SEEDS_IDS.NEW_CUSTOMERS,
    kpiName: 'Khách hàng mới',
    kpiCode: MktKpiCode.NEW_CUSTOMERS,
    kpiType: 'NEW_CUSTOMERS',
    kpiCategory: 'SALES',
    description: 'Số lượng khách hàng mới đăng ký trong tháng',
    targetValue: 100,
    actualValue: 85,
    unitOfMeasure: 'COUNT',
    periodType: 'MONTHLY',
    periodYear: 2024,
    periodQuarter: 4,
    periodMonth: 12,
    periodWeek: 49,
    periodStartDate: '2024-12-01',
    periodEndDate: '2024-12-31',
    assigneeType: 'INDIVIDUAL',
    status: 'IN_PROGRESS',
    achievedAt: null,
    isAutoCalculated: true,
    calculationFormula: 'COUNT(customers) WHERE created_date >= period_start',
    alertThresholds: {
      warning: 80,
      critical: 60,
    },
    notes: 'Theo dõi số lượng khách hàng mới hàng tháng',
    priority: 'HIGH',
    weight: 80,
    position: 2,
    assignedToId: WORKSPACE_MEMBER_DATA_SEED_IDS.JANE,
  },

  // Sales Conversion Rate KPI
  {
    id: MKT_KPI_DATA_SEEDS_IDS.SALES_CONVERSION_RATE,
    kpiName: 'Tỷ lệ chuyển đổi bán hàng',
    kpiCode: MktKpiCode.SALES_CONVERSION_RATE,
    kpiType: 'CONVERSION_RATE',
    kpiCategory: 'SALES',
    description: 'Tỷ lệ chuyển đổi từ lead thành khách hàng',
    targetValue: 25,
    actualValue: 22,
    unitOfMeasure: 'PERCENT',
    periodType: 'MONTHLY',
    periodYear: 2024,
    periodQuarter: 4,
    periodMonth: 12,
    periodWeek: 49,
    periodStartDate: '2024-12-01',
    periodEndDate: '2024-12-31',
    assigneeType: 'TEAM',
    status: 'IN_PROGRESS',
    achievedAt: null,
    isAutoCalculated: true,
    calculationFormula: '(customers_converted / total_leads) * 100',
    alertThresholds: {
      warning: 20,
      critical: 15,
    },
    notes: 'Đo lường hiệu quả chuyển đổi từ lead thành khách hàng',
    priority: 'MEDIUM',
    weight: 70,
    position: 3,
    assignedToId: WORKSPACE_MEMBER_DATA_SEED_IDS.JONY,
  },

  // Support Response Time KPI
  {
    id: MKT_KPI_DATA_SEEDS_IDS.SUPPORT_RESPONSE_TIME,
    kpiName: 'Thời gian phản hồi hỗ trợ',
    kpiCode: MktKpiCode.SUPPORT_RESPONSE_TIME,
    kpiType: 'RESPONSE_TIME',
    kpiCategory: 'SUPPORT',
    description: 'Thời gian trung bình phản hồi ticket hỗ trợ khách hàng',
    targetValue: 2,
    actualValue: 3.5,
    unitOfMeasure: 'HOURS',
    periodType: 'MONTHLY',
    periodYear: 2024,
    periodQuarter: 4,
    periodMonth: 12,
    periodWeek: 49,
    periodStartDate: '2024-12-01',
    periodEndDate: '2024-12-31',
    assigneeType: 'DEPARTMENT',
    status: 'NOT_ACHIEVED',
    achievedAt: null,
    isAutoCalculated: true,
    calculationFormula: 'AVG(support_tickets.response_time)',
    alertThresholds: {
      warning: 4,
      critical: 6,
    },
    notes: 'Cần cải thiện thời gian phản hồi',
    priority: 'HIGH',
    weight: 90,
    position: 4,
    assignedToId: null,
  },

  // Customer Satisfaction KPI
  {
    id: MKT_KPI_DATA_SEEDS_IDS.CUSTOMER_SATISFACTION,
    kpiName: 'Điểm hài lòng khách hàng',
    kpiCode: MktKpiCode.CUSTOMER_SATISFACTION,
    kpiType: 'SATISFACTION_SCORE',
    kpiCategory: 'SUPPORT',
    description: 'Điểm trung bình đánh giá hài lòng của khách hàng',
    targetValue: 4.5,
    actualValue: 4.2,
    unitOfMeasure: 'COUNT',
    periodType: 'MONTHLY',
    periodYear: 2024,
    periodQuarter: 4,
    periodMonth: 12,
    periodWeek: 49,
    periodStartDate: '2024-12-01',
    periodEndDate: '2024-12-31',
    assigneeType: 'DEPARTMENT',
    status: 'IN_PROGRESS',
    achievedAt: null,
    isAutoCalculated: true,
    calculationFormula: 'AVG(survey_results.satisfaction_score)',
    alertThresholds: {
      warning: 4.0,
      critical: 3.5,
    },
    notes: 'Đo lường mức độ hài lòng của khách hàng đối với dịch vụ',
    priority: 'MEDIUM',
    weight: 85,
    position: 5,
    assignedToId: null,
  },

  // Monthly Calls KPI
  {
    id: MKT_KPI_DATA_SEEDS_IDS.MONTHLY_CALLS,
    kpiName: 'Số cuộc gọi tháng',
    kpiCode: MktKpiCode.MONTHLY_CALLS,
    kpiType: 'CALLS',
    kpiCategory: 'SALES',
    description: 'Tổng số cuộc gọi bán hàng thực hiện trong tháng',
    targetValue: 500,
    actualValue: 420,
    unitOfMeasure: 'COUNT',
    periodType: 'MONTHLY',
    periodYear: 2024,
    periodQuarter: 4,
    periodMonth: 12,
    periodWeek: 49,
    periodStartDate: '2024-12-01',
    periodEndDate: '2024-12-31',
    assigneeType: 'INDIVIDUAL',
    status: 'IN_PROGRESS',
    achievedAt: null,
    isAutoCalculated: false,
    calculationFormula: 'Manual tracking of sales calls',
    alertThresholds: {
      warning: 450,
      critical: 400,
    },
    notes: 'Cần tăng cường hoạt động gọi khách hàng',
    priority: 'MEDIUM',
    weight: 60,
    position: 6,
    assignedToId: null,
  },

  // Demos Completed KPI
  {
    id: MKT_KPI_DATA_SEEDS_IDS.DEMOS_COMPLETED,
    kpiName: 'Demo hoàn thành',
    kpiCode: MktKpiCode.DEMOS_COMPLETED,
    kpiType: 'DEMOS',
    kpiCategory: 'SALES',
    description: 'Số lượng demo sản phẩm hoàn thành cho khách hàng tiềm năng',
    targetValue: 50,
    actualValue: 45,
    unitOfMeasure: 'COUNT',
    periodType: 'MONTHLY',
    periodYear: 2024,
    periodQuarter: 4,
    periodMonth: 12,
    periodWeek: 49,
    periodStartDate: '2024-12-01',
    periodEndDate: '2024-12-31',
    assigneeType: 'TEAM',
    status: 'IN_PROGRESS',
    achievedAt: null,
    isAutoCalculated: false,
    calculationFormula: 'Manual tracking of completed demos',
    alertThresholds: {
      warning: 40,
      critical: 30,
    },
    notes: 'Track số lượng demo cho khách hàng tiềm năng',
    priority: 'MEDIUM',
    weight: 65,
    position: 7,
    assignedToId: null,
  },

  // Deals Closed KPI
  {
    id: MKT_KPI_DATA_SEEDS_IDS.DEALS_CLOSED,
    kpiName: 'Giao dịch đóng thành công',
    kpiCode: MktKpiCode.DEALS_CLOSED,
    kpiType: 'DEALS_CLOSED',
    kpiCategory: 'SALES',
    description: 'Số lượng giao dịch bán hàng đóng thành công',
    targetValue: 30,
    actualValue: 28,
    unitOfMeasure: 'COUNT',
    periodType: 'MONTHLY',
    periodYear: 2024,
    periodQuarter: 4,
    periodMonth: 12,
    periodWeek: 49,
    periodStartDate: '2024-12-01',
    periodEndDate: '2024-12-31',
    assigneeType: 'INDIVIDUAL',
    status: 'IN_PROGRESS',
    achievedAt: null,
    isAutoCalculated: true,
    calculationFormula: 'COUNT(deals) WHERE status = "WON"',
    alertThresholds: {
      warning: 25,
      critical: 20,
    },
    notes: 'Theo dõi số lượng deal đóng thành công trong tháng',
    priority: 'HIGH',
    weight: 95,
    position: 8,
    assignedToId: null,
  },

  // Customer Retention KPI
  {
    id: MKT_KPI_DATA_SEEDS_IDS.CUSTOMER_RETENTION,
    kpiName: 'Tỷ lệ giữ chân khách hàng',
    kpiCode: MktKpiCode.CUSTOMER_RETENTION,
    kpiType: 'RETENTION_RATE',
    kpiCategory: 'MARKETING',
    description: 'Tỷ lệ khách hàng tiếp tục sử dụng dịch vụ',
    targetValue: 95,
    actualValue: 92,
    unitOfMeasure: 'PERCENT',
    periodType: 'QUARTERLY',
    periodYear: 2024,
    periodQuarter: 4,
    periodMonth: 12,
    periodWeek: 52,
    periodStartDate: '2024-10-01',
    periodEndDate: '2024-12-31',
    assigneeType: 'DEPARTMENT',
    status: 'IN_PROGRESS',
    achievedAt: null,
    isAutoCalculated: true,
    calculationFormula:
      '(retained_customers / total_customers_start_period) * 100',
    alertThresholds: {
      warning: 90,
      critical: 85,
    },
    notes: 'Đo lường khả năng giữ chân khách hàng trong dài hạn',
    priority: 'HIGH',
    weight: 88,
    position: 9,
    assignedToId: null,
  },

  // Tech Project Completion KPI
  {
    id: MKT_KPI_DATA_SEEDS_IDS.TECH_PROJECT_COMPLETION,
    kpiName: 'Hoàn thành dự án kỹ thuật',
    kpiCode: MktKpiCode.TECH_PROJECT_COMPLETION,
    kpiType: 'CUSTOM',
    kpiCategory: 'OPERATIONS',
    description: 'Tỷ lệ hoàn thành đúng hạn các dự án kỹ thuật',
    targetValue: 90,
    actualValue: 85,
    unitOfMeasure: 'PERCENT',
    periodType: 'QUARTERLY',
    periodYear: 2024,
    periodQuarter: 4,
    periodMonth: 12,
    periodWeek: 52,
    periodStartDate: '2024-10-01',
    periodEndDate: '2024-12-31',
    assigneeType: 'DEPARTMENT',
    status: 'IN_PROGRESS',
    achievedAt: null,
    isAutoCalculated: false,
    calculationFormula: 'Manual tracking of project completion on time',
    alertThresholds: {
      warning: 80,
      critical: 70,
    },
    notes: 'Cần cải thiện quy trình quản lý dự án',
    priority: 'MEDIUM',
    weight: 75,
    position: 10,
    assignedToId: WORKSPACE_MEMBER_DATA_SEED_IDS.PHIL,
  },
];
